<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Dev's Burguer</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div th:replace="~{fragments/header :: cabecalho}"></div>

<main class="checkout">

    <form th:action="@{/confirmarPedido}" method="post" id="checkout-form">
        <h1>Finalizar Pedido</h1>
        <div class="campo">
            <label for="cep">CEP</label>
            <input id="cep" name="cep" class="campo-cep" type="text" required>
        </div>
        <div class="campo">
            <label for="endereco">Endereço</label>
            <input id="endereco" name="endereco" type="text" required>
        </div>
        <div class="campo">
            <label for="numero">Número</label>
            <input id="numero" name="numero" type="text" required>
        </div>
        <div class="campo">
            <label for="bairro">Bairro</label>
            <input id="bairro" name="bairro" type="text" required>
        </div>
        <div class="campo">
            <label for="cidade">Cidade</label>
            <input id="cidade" name="cidade" type="text" required>
        </div>
        <div class="campo">
            <label for="estado">Estado</label>
            <input id="estado" name="estado" type="text" required>
        </div>
        <div class="campo">
            <label for="complemento">Complemento (Opcional)</label>
            <input id="complemento" name="complemento" type="text" />
        </div>

        <section class="pagamento">
            <h2>Pagamento</h2>
            <p>O pagamento é feito na entrega. Escolha a forma que deseja pagar</p>
            <div class="opcoes-pagamento">
                <label for="credito" class="opcao-pagamento">
                    <input type="radio" id="credito" name="formaPagamento" value="CREDITO" /> <span>Cartão de Crédito</span>
                </label>
                <label for="debito" class="opcao-pagamento">
                    <input type="radio" id="debito" name="formaPagamento" value="DEBITO" /> <span>Cartão de Débito</span>
                </label>
                <label for="dinheiro" class="opcao-pagamento">
                    <input type="radio" id="dinheiro" name="formaPagamento" value="DINHEIRO" /> <span>Dinheiro</span>
                </label>
            </div>
        </section>
    </form>

    <div class="resumo">
        <h2>Resumo do pedido</h2>

        <div th:if="${carrinho == null || carrinho.itens.isEmpty()}">
            <p>Nenhum item adicionado.</p>
        </div>

        <div th:unless="${carrinho == null || carrinho.itens.isEmpty()}">

            <div class="item-resumo" th:each="item : ${carrinho.itens}">

                <img th:src="@{/images/{url}(url=${item.imagemUrl})}" alt="Imagem do produto"/>

                <div class="detalhes-item">
                    <span th:text="${item.nomeProduto}">Stake de Bacon</span>

                    <span class="preco" th:text="${#numbers.formatCurrency(item.precoUnitario)}">R$ 29,90</span>

                    <div class="acoes-item">

                        <form th:action="@{/atualizarQuantidade}" method="post" class="form-quantidade">

                            <input type="hidden" name="itemPedidoId" th:value="${item.itemPedidoId}" />

                            <input type="number" name="quantidade" th:value="${item.quantidade}" min="1"
                                   class="input-quantidade"
                                   onchange="this.form.submit()" /> </form>

                        <form th:action="@{/removerItem}" method="post" style="display: inline;">
                            <input type="hidden" name="itemPedidoId" th:value="${item.itemPedidoId}" />
                            <button type="submit" class="btn-remover">REMOVER</button>
                        </form>

                    </div>
                </div>
            </div>

            <hr/>

            <div class="totais">
                <p><span>Total de itens:</span> <span th:text="${#numbers.formatCurrency(carrinho.subtotal)}">R$ 38,80</span></p>
                <p><span>Entrega:</span> <span th:text="${#numbers.formatCurrency(carrinho.frete)}">R$ 3,50</span></p>
                <p class="total-final"><span>Total:</span> <span th:text="${#numbers.formatCurrency(carrinho.total)}">R$ 42,30</span></p>
            </div>
            <button type="submit" class="btn-confirmar" form="checkout-form">Confirmar Pedido</button>
        </div>
    </div>
</main>
</body>
</html>